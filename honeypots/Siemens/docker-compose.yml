version: '3.8'

services:
  plc-honeypot:
    build: .
    container_name: sim-plc
    ports:
      - "502:502"  # Expose Modbus TCP
    cap_add:
      - NET_BIND_SERVICE  # Allows binding to port 502 without full privileged mode
    restart: unless-stopped
    volumes:
      - ./logs:/app/logs  # Ensure /app/logs exists inside container
    healthcheck:
      test: ["CMD", "ss", "-ltn", "|", "grep", "502"]
      interval: 30s
      timeout: 5s
      retries: 3
    networks:
      - honeynet

networks:
  honeynet:
    driver: bridge
